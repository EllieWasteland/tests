<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web OS</title>
    <!-- Tailwind CSS para un diseño rápido y moderno -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google API Libraries with onload callbacks -->
    <script src="https://apis.google.com/js/api.js?onload=gapiLoaded" async defer></script>
    <script src="https://accounts.google.com/gsi/client?onload=gisLoaded" async defer></script>
    <!-- Estilos personalizados y configuración de fuentes -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <div id="animated-bg" class="zoomed-in"></div>

    <!-- Onboarding Screen -->
    <div id="onboarding-screen" class="screen fixed inset-0 z-40 flex items-center justify-center p-4">
        <div class="w-full max-w-sm md:max-w-3xl h-[600px] md:h-[450px] bg-pink-200 rounded-3xl shadow-2xl flex overflow-hidden border border-pink-300 backdrop-blur-md bg-opacity-80">
            <!-- Onboarding Step 1: Accent Color -->
            <div id="onboarding-step-1" class="onboarding-step w-full h-full flex flex-col md:flex-row">
                <div class="w-full h-1/3 md:w-1/3 md:h-full">
                    <img src="https://images.unsplash.com/photo-1558591710-4b4a1ae0f04d?q=80&w=1887&auto=format&fit=crop" class="w-full h-full object-cover rounded-t-3xl md:rounded-l-3xl md:rounded-tr-none" alt="Abstract pink shapes">
                </div>
                <div class="w-full h-2/3 md:w-2/3 md:h-full p-6 md:p-8 flex flex-col">
                    <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-2">¡Bienvenido a tu nuevo espacio!</h2>
                    <p class="text-gray-600 mb-6">Personaliza tu experiencia eligiendo un color de acento que te represente.</p>
                    <div class="flex-grow flex items-center justify-center gap-4">
                        <button class="w-12 h-12 md:w-16 md:h-16 rounded-full bg-pink-400 transform hover:scale-110 transition-transform focus:outline-none focus:ring-4 ring-pink-300"></button>
                        <button class="w-12 h-12 md:w-16 md:h-16 rounded-full bg-rose-400 transform hover:scale-110 transition-transform focus:outline-none focus:ring-4 ring-rose-300"></button>
                        <button class="w-12 h-12 md:w-16 md:h-16 rounded-full bg-fuchsia-400 transform hover:scale-110 transition-transform focus:outline-none focus:ring-4 ring-fuchsia-300"></button>
                        <button class="w-12 h-12 md:w-16 md:h-16 rounded-full bg-purple-400 transform hover:scale-110 transition-transform focus:outline-none focus:ring-4 ring-purple-300"></button>
                        <button class="w-12 h-12 md:w-16 md:h-16 rounded-full bg-indigo-400 transform hover:scale-110 transition-transform focus:outline-none focus:ring-4 ring-indigo-300"></button>
                    </div>
                    <button data-next-step="2" class="onboarding-next-btn self-end w-14 h-14 bg-pink-500 text-white rounded-full hover:bg-pink-600 transition-colors shadow-lg flex items-center justify-center transform hover:scale-110">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M14 5l7 7m0 0l-7 7m7-7H3" />
                        </svg>
                    </button>
                </div>
            </div>
            <!-- Onboarding Step 2: Terms of Use -->
            <div id="onboarding-step-2" class="onboarding-step w-full h-full flex flex-col md:flex-row absolute inset-0 opacity-0 pointer-events-none">
                <div class="w-full h-1/3 md:w-1/3 md:h-full">
                    <img src="https://images.unsplash.com/photo-1614099232631-4516752b6f13?q=80&w=1887&auto=format&fit=crop" class="w-full h-full object-cover rounded-t-3xl md:rounded-l-3xl md:rounded-tr-none" alt="Abstract flowing lines">
                </div>
                <div class="w-full h-2/3 md:w-2/3 md:h-full p-6 md:p-8 flex flex-col">
                    <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-2">Acuerdos de Uso</h2>
                    <p class="text-gray-600 mb-4 flex-grow overflow-auto pr-2 text-sm">
                        Antes de continuar, por favor lee y acepta nuestros términos y condiciones. Este documento describe tus derechos y responsabilidades como usuario de nuestro sistema operativo web. Al hacer clic en "Aceptar y Continuar", confirmas que has leído, entendido y aceptado estar sujeto a estos términos. El uso continuado del servicio constituirá la aceptación de cualquier actualización futura de estos términos. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus. Suspendisse lectus tortor, dignissim sit amet, adipiscing nec, ultricies sed, dolor.
                    </p>
                    <button id="finish-onboarding-btn" class="self-end w-14 h-14 bg-pink-500 text-white rounded-full hover:bg-pink-600 transition-colors shadow-lg flex items-center justify-center transform hover:scale-110">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M14 5l7 7m0 0l-7 7m7-7H3" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Screen -->
    <div id="login-screen" class="screen fixed inset-0 z-50 flex items-center justify-center p-4 opacity-0 pointer-events-none">
        <div class="relative w-full max-w-sm h-[500px]">
            <!-- Step 1: Choice -->
            <div id="login-step-1" class="login-step w-full h-full absolute top-0 left-0">
                <div class="w-full h-full p-8 bg-pink-200 rounded-3xl shadow-2xl flex flex-col items-center justify-center border border-pink-300 backdrop-blur-md bg-opacity-80">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2 text-center">¿Cómo quieres empezar?</h2>
                    <p class="text-gray-600 mb-8 text-center">Tus datos, a tu manera.</p>
                    <div class="w-full grid grid-cols-2 gap-4">
                        <button id="google-login-choice-btn" class="h-48 flex flex-col justify-between items-center bg-white/50 hover:bg-white/80 transition-all p-4 rounded-2xl shadow-md border border-white/60 transform hover:scale-105">
                            <span class="font-semibold text-gray-700">Cargando API...</span>
                            <svg class="w-16 h-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path fill="#4285F4" d="M24 9.8c3.3 0 5.8 1.4 7.6 3.1l5.8-5.8C34.2 4.1 29.6 2 24 2 14.8 2 7.3 7.8 4 15.9l7 5.4c1.4-4.2 5.3-7.5 9.9-7.5z"/><path fill="#34A853" d="M24 46c5.5 0 10.2-1.9 13.6-5.1l-6.6-5.1c-1.8 1.2-4.1 2-6.9 2-4.6 0-8.5-3.3-9.9-7.5l-7 5.4C7.3 40.2 14.8 46 24 46z"/><path fill="#FBBC05" d="M14.1 28.2c-.5-1.5-.7-3.1-.7-4.8s.2-3.3.7-4.8l-7-5.4C5.5 16.4 4 20 4 24c0 4 .5 7.6 1.9 11.2l7.2-5.8z"/><path fill="#EA4335" d="M24 17.3c2.6 0 4.7.9 6.2 2.3l6-6C33.3 10.8 29.1 9 24 9c-8.2 0-15.2 5.7-18.1 13.5L13 28c1.3-4.4 5.3-7.7 11-7.7z"/><path fill="none" d="M2 2h44v44H2z"/></svg>
                        </button>
                        <button id="offline-login-choice-btn" class="h-48 flex flex-col justify-between items-center bg-white/50 hover:bg-white/80 transition-all p-4 rounded-2xl shadow-md border border-white/60 transform hover:scale-105">
                             <span class="font-semibold text-gray-700">Sin conexión</span>
                            <svg class="w-16 h-16 text-gray-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" /></svg>
                        </button>
                    </div>
                </div>
            </div>
            <!-- Step 2: Username & Photo -->
            <div id="login-step-2" class="login-step w-full h-full absolute top-0 left-0 opacity-0 pointer-events-none">
                 <div class="w-full h-full p-8 bg-pink-200 rounded-3xl shadow-2xl flex flex-col justify-between border border-pink-300 backdrop-blur-md bg-opacity-80">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800 mb-2 text-center">Crea tu perfil</h2>
                        <p class="text-gray-600 mb-8 text-center">Añade un nombre y una foto.</p>
                    </div>
                    <form id="username-form" class="w-full flex flex-col items-center">
                        <div class="relative mb-6">
                            <img id="profile-pic-preview" src="https://i.pravatar.cc/150?u=a042581f4e29026704d" alt="Foto de perfil" class="w-32 h-32 rounded-full object-cover shadow-lg border-4 border-white/50">
                            <label for="profile-pic-input" class="absolute bottom-0 right-0 w-10 h-10 bg-pink-500 rounded-full flex items-center justify-center text-white cursor-pointer hover:bg-pink-600 transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.175 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.776 48.776 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z" /><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z" /></svg>
                            </label>
                            <input id="profile-pic-input" type="file" class="hidden" accept="image/*">
                        </div>
                        <input id="username-input" type="text" placeholder="Escribe tu nombre aquí" class="w-full text-center bg-white/70 border border-pink-200 rounded-lg py-3 px-4 focus:outline-none focus:ring-2 focus:ring-pink-400 text-gray-700" required>
                    </form>
                    <button id="username-submit-btn" class="self-end w-14 h-14 bg-pink-500 text-white rounded-full hover:bg-pink-600 transition-colors shadow-lg flex items-center justify-center transform hover:scale-110">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M14 5l7 7m0 0l-7 7m7-7H3" />
                        </svg>
                    </button>
                </div>
            </div>
            <!-- Step 3: PIN -->
            <div id="login-step-3" class="login-step w-full h-full absolute top-0 left-0 opacity-0 pointer-events-none">
                 <div class="w-full h-full p-8 bg-pink-200 rounded-3xl shadow-2xl flex flex-col justify-center border border-pink-300 backdrop-blur-md bg-opacity-80">
                    <div>
                        <h2 id="pin-greeting" class="text-2xl font-bold text-gray-800 mb-2 text-center">Crea tu PIN</h2>
                        <p id="pin-subtitle" class="text-gray-600 mb-8 text-center">Un PIN de 4 dígitos para tu seguridad.</p>
                        <div id="pin-dots-container" class="flex justify-center gap-4 mb-8">
                            <div class="pin-display-dot w-4 h-4 bg-white/50 rounded-full"></div>
                            <div class="pin-display-dot w-4 h-4 bg-white/50 rounded-full"></div>
                            <div class="pin-display-dot w-4 h-4 bg-white/50 rounded-full"></div>
                            <div class="pin-display-dot w-4 h-4 bg-white/50 rounded-full"></div>
                        </div>
                    </div>
                    <div id="pin-keypad" class="grid grid-cols-3 gap-4 w-max mx-auto">
                        <!-- Keypad buttons will be generated by JS -->
                    </div>
                 </div>
            </div>
        </div>
    </div>

    <!-- Notification Element -->
    <div id="notification" class="fixed top-5 right-5 bg-green-500 text-white py-2 px-4 rounded-lg shadow-md transform translate-x-[120%] transition-transform duration-300">
        Sync complete!
    </div>


    <!-- Main App Content -->
    <div id="main-content" class="opacity-0 pointer-events-none">
        <main id="desktop" class="h-screen w-screen relative p-4 md:p-6">
            <div id="app-window" class="hidden absolute bg-pink-50 rounded-2xl shadow-2xl flex flex-col overflow-hidden border border-pink-200">
                <header class="bg-pink-100 px-4 py-2 flex items-center justify-between border-b border-pink-200 cursor-move">
                    <div class="flex items-center gap-2">
                        <div id="window-icon" class="w-6 h-6"></div>
                        <h2 id="window-title" class="font-semibold text-gray-800">Nombre de la App</h2>
                    </div>
                    <div class="flex items-center gap-2">
                        <button id="maximize-window-btn" class="w-6 h-6 bg-green-300 rounded-full hover:bg-green-400 focus:outline-none focus:ring-2 focus:ring-green-200 transition-colors flex items-center justify-center"></button>
                        <button id="close-window-btn" class="w-6 h-6 bg-red-400 rounded-full hover:bg-red-500 focus:outline-none focus:ring-2 focus:ring-red-300 transition-colors"></button>
                    </div>
                </header>
                <div class="flex-grow rounded-b-2xl overflow-hidden flex items-center justify-center">
                    <div id="loader" class="spinner">
                        <div></div><div></div><div></div><div></div><div></div><div></div>
                    </div>
                    <iframe id="app-content-frame" src="about:blank" class="w-full h-full border-none app-content hidden" title="App Content"></iframe>
                </div>
            </div>
        </main>
        
        <div id="start-menu" class="hidden absolute bottom-20 left-4 w-96 h-[480px] bg-pink-100 rounded-2xl shadow-2xl p-4 flex flex-col justify-start border border-pink-200">
            <h2 id="greeting" class="text-3xl font-bold text-gray-800 text-center mb-4 animate-on-show"></h2>
            <div class="relative flex items-center justify-center mx-auto animate-on-show" style="--s: 220px;">
                <div class="wavy-circle-spinner shadow-md"></div>
                <img id="start-menu-avatar" src="https://i.pravatar.cc/180?u=eleanor" alt="User Avatar" class="absolute w-[180px] h-[180px] rounded-full object-cover shadow-lg border-4 border-pink-100">
            </div>
            <div class="flex-grow animate-on-show"></div>
            <div class="flex items-center justify-center gap-3 w-full animate-on-show">
                <button class="w-12 h-12 bg-pink-200 hover:bg-pink-300 transition rounded-full flex items-center justify-center text-pink-700 shadow-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" /></svg>
                </button>
                <button class="w-12 h-12 bg-pink-200 hover:bg-pink-300 transition rounded-full flex items-center justify-center text-pink-700 shadow-sm">
                     <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06-.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
                </button>
                <button id="sync-cloud-btn" class="px-5 py-3 bg-pink-200 hover:bg-pink-300 transition rounded-full flex items-center justify-center text-pink-700 shadow-sm text-sm font-semibold">Sincronizar en la nube</button>
                <button class="px-5 py-3 bg-pink-200 hover:bg-pink-300 transition rounded-full flex items-center justify-center text-pink-700 shadow-sm text-sm font-semibold">Apps</button>
                <button class="px-5 py-3 bg-pink-200 hover:bg-pink-300 transition rounded-full flex items-center justify-center text-pink-700 shadow-sm text-sm font-semibold">Perfil</button>
            </div>
        </div>

        <nav class="fixed bottom-4 left-4 right-4 bg-pink-200 px-3 py-2 rounded-full shadow-lg border border-pink-300">
            <div class="flex items-center justify-between w-full">
                <div class="flex items-center gap-3">
                    <button id="start-btn" class="pulsating-btn w-10 h-10 bg-white rounded-full shadow-lg focus:outline-none focus:ring-4 focus:ring-white/50 bg-cover bg-center" style="background-image: url('https://i.pravatar.cc/40?u=eleanor')"></button>
                    <div class="w-px h-6 bg-pink-300"></div>
                    <div class="flex items-center gap-3">
                        <button class="app-icon w-10 h-10 bg-rose-400 rounded-full flex items-center justify-center text-white text-xl shadow-md hover:scale-110 transition-transform focus:outline-none focus:ring-4 focus:ring-rose-300" data-url="https://www.wikipedia.org/" data-title="Navegador" data-icon-svg='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>'></button>
                        <button class="app-icon w-10 h-10 bg-fuchsia-400 rounded-full flex items-center justify-center text-white text-xl shadow-md hover:scale-110 transition-transform focus:outline-none focus:ring-4 focus:ring-fuchsia-300" data-url="https://open.spotify.com/embed/playlist/37i9dQZF1DXcBWIGoYBM5M" data-title="Música" data-icon-svg='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V5l12-2v13"></path><circle cx="6" cy="18" r="3"></circle><circle cx="18" cy="16" r="3"></circle></svg>'></button>
                        <button class="app-icon w-10 h-10 bg-purple-400 rounded-full flex items-center justify-center text-white text-xl shadow-md hover:scale-110 transition-transform focus:outline-none focus:ring-4 focus:ring-purple-300" data-url="https://www.bing.com/" data-title="Archivos" data-icon-svg='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>'></button>
                        <button class="app-icon w-10 h-10 bg-indigo-400 rounded-full flex items-center justify-center text-white text-xl shadow-md hover:scale-110 transition-transform focus:outline-none focus:ring-4 focus:ring-indigo-300" data-url="https://duckduckgo.com/" data-title="Ajustes" data-icon-svg='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06-.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>'></button>
                    </div>
                </div>
                <div id="clock-container">
                    <div id="clock" class="bg-pink-100 text-gray-800 text-sm font-semibold px-4 py-1.5 rounded-full"></div>
                </div>
            </div>
        </nav>
    </div>
    <script type="module" src="main.js"></script>
</body>
</html>

