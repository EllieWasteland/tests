<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asistente de Configuración Eduroam - UCuenca</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">
    <style>
        html, body {
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-image: url('https://i.pinimg.com/1200x/d7/2d/c3/d72dc3cee61f693fdb1793b6f6ab33c9.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            color: #1a1a1a;
            min-height: 100vh;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        #parallax-scene {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            perspective: 1000px;
        }

        .layer {
             position: absolute;
             top:0; left:0; right:0; bottom:0;
             display: flex;
             align-items: center;
             justify-content: center;
             transition: transform 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .sparkle { position: absolute; width: 50px; height: 50px; color: #1a1a1a; opacity: 0; animation: fadeIn 1s ease-out 2.5s forwards; }
        .sparkle-1 { top: 15%; left: 5%; transform: rotate(15deg) scale(0.8); }
        .sparkle-2 { top: 25%; right: 10%; transform: rotate(-10deg); animation-delay: 2.7s; }
        .sparkle-3 { bottom: 20%; left: 20%; transform: rotate(25deg) scale(1.2); animation-delay: 2.9s;}

        .floating-element { position: absolute; border-radius: 50%; background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.5), rgba(255,255,255,0) 70%), rgba(128, 90, 213, 0.2); box-shadow: inset 0 0 20px rgba(255,255,255,0.3), 0 10px 25px rgba(0,0,0,0.1); animation: float 20s infinite ease-in-out; }
        #float1 { width: 200px; height: 200px; top: 10%; left: -5%; animation-duration: 25s;}
        #float2 { width: 150px; height: 150px; top: 70%; right: -3%; animation-duration: 30s; animation-delay: 5s;}
        #float3 { width: 80px; height: 80px; top: 80%; left: 10%; animation-duration: 18s; animation-delay: 2s;}
        #float4 { width: 120px; height: 120px; top: 5%; right: 25%; animation-duration: 22s; animation-delay: 8s;}

        .glass-pane {
            background: rgba(255, 255, 255, 0.45);
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 24px;
            box-shadow: 0 10px 35px rgba(0, 0, 0, 0.15), 0 2px 10px rgba(0, 0, 0, 0.1);
            height: 90vh; max-height: 700px; width: 90vw; max-width: 480px;
            display: flex; flex-direction: column;
            opacity: 0; transform: scale(0.95);
            transition: opacity 0.8s cubic-bezier(0.16, 1, 0.3, 1), transform 0.8s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .glass-pane.parallax-active {
            transition: opacity 0.8s cubic-bezier(0.16, 1, 0.3, 1), transform 0.1s linear;
        }
        .glass-pane.visible { opacity: 1; transform: scale(1); }

        #splash-screen {
            transition: opacity 0.7s ease-out, background-color 0.5s ease, backdrop-filter 0.5s ease;
            overflow: hidden;
        }
        #splash-screen.glass-active {
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        #particle-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        @keyframes fadeIn { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }
        @keyframes slideInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes popIn { 0% { opacity: 0; transform: scale(0.5); } 80% { opacity: 1; transform: scale(1.1); } 100% { opacity: 1; transform: scale(1); } }
        @keyframes float { 0% { transform: translateY(0) translateX(0) scale(1) rotate(0deg); } 25% { transform: translateY(-30px) translateX(20px) scale(1.1) rotate(20deg); } 50% { transform: translateY(20px) translateX(-30px) scale(0.9) rotate(-10deg); } 75% { transform: translateY(-10px) translateX(40px) scale(1) rotate(15deg); } 100% { transform: translateY(0) translateX(0) scale(1) rotate(0deg); } }
        @keyframes final-pop { 0% { transform: scale(0.8); opacity: 0; } 50% { transform: scale(1.2); opacity: 1; } 100% { transform: scale(1); opacity: 1; } }
        
        .animated-item { opacity: 0; }
        /* ANIMACIÓN MEJORADA: Usamos un cubic-bezier con más 'rebote' */
        .current .animated-item { animation: slideInUp 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }
        .current .animated-icon { animation: popIn 0.7s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }
        
        #steps-container { flex: 1; position: relative; overflow: hidden; }
        .step { width: 100%; height: 100%; position: absolute; top: 0; left: 0; display: flex; flex-direction: column; transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1); }
        .step.future { transform: translateX(100%); }
        .step.past { transform: translateX(-100%); }
        .step.current { transform: translateX(0); }
        .progress-bar-fill { transition: width 0.7s cubic-bezier(0.4, 0, 0.2, 1); }

        /* Animación para el ícono de WiFi de Windows */
        #wifi-icon-anim .wifi-symbol { animation: pulse-wifi 2s infinite ease-in-out; transform-origin: bottom center; }
        #wifi-icon-anim .wifi-symbol path { fill: #333; }
        #wifi-icon-anim .cursor { animation: click-cursor 2s infinite ease-in-out; transform-origin: top left; }
        @keyframes pulse-wifi { 0%, 100% { opacity: 0.8; } 50% { opacity: 1; } }
        @keyframes click-cursor { 0%, 40%, 100% { transform: translate(0, 0); } 50%, 60% { transform: translate(2px, 2px); } }

    </style>
</head>
<body>
    <!-- Splash Screen Mejorado -->
    <div id="splash-screen" class="fixed inset-0 bg-[#F5EEFF] z-50 flex flex-col items-center justify-center text-center p-4">
        <div id="splash-content" class="transition-opacity duration-500 flex flex-col items-center justify-center w-full h-full">
            <div id="detection-state" class="w-full h-full flex items-center justify-center relative">
                <canvas id="particle-canvas"></canvas>
                <p id="splash-text" class="text-lg text-gray-700 font-semibold animate-pulse">Detectando tu dispositivo...</p>
            </div>
            <div id="shake-state" class="hidden opacity-0 transition-opacity duration-700 flex-col items-center justify-center">
                <div id="os-logo-container" class="w-28 h-28 mx-auto mb-6"></div>
                <h2 class="text-2xl font-bold text-gray-800">¡Dispositivo Detectado!</h2>
                <p class="text-lg text-gray-600 mt-2">Agita tu dispositivo para continuar</p>
                <p id="ios-permission-text" class="text-xs text-gray-500 mt-4 max-w-xs mx-auto hidden">En iOS, toca la pantalla una vez para activar los sensores de movimiento.</p>
                <button id="fallback-btn" class="hidden opacity-0 transition-all duration-500 mt-8 bg-gray-800/80 p-3 rounded-full shadow-lg hover:scale-110 focus:outline-none"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6" /></svg></button>
            </div>
        </div>
    </div>
    
    <div id="parallax-scene">
        <div class="layer" data-depth="0.3"><svg class="sparkle sparkle-1" viewBox="0 0 54 54" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M27 0L32.226 21.774L54 27L32.226 32.226L27 54L21.774 32.226L0 27L21.774 21.774L27 0Z" fill="currentColor"/></svg></div>
        <div class="layer" data-depth="0.2"><svg class="sparkle sparkle-2" viewBox="0 0 54 54" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M27 0L32.226 21.774L54 27L32.226 32.226L27 54L21.774 32.226L0 27L21.774 21.774L27 0Z" fill="currentColor"/></svg></div>
        <div class="layer" data-depth="0.4"><svg class="sparkle sparkle-3" viewBox="0 0 54 54" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M27 0L32.226 21.774L54 27L32.226 32.226L27 54L21.774 32.226L0 27L21.774 21.774L27 0Z" fill="currentColor"/></svg></div>
        <div class="layer" data-depth="0.2"><div id="float1" class="floating-element"></div></div>
        <div class="layer" data-depth="0.4"><div id="float2" class="floating-element"></div></div>
        <div class="layer" data-depth="-0.2"><div id="float3" class="floating-element"></div></div>
        <div class="layer" data-depth="0.3"><div id="float4" class="floating-element"></div></div>

        <div class="layer" data-depth="-0.3">
            <div class="glass-pane">
                <div class="relative flex flex-col h-full w-full">
                    <div class="p-4 sm:p-6 flex-shrink-0" data-depth-inside="0.1"><div class="w-full bg-black/10 rounded-full h-2"><div id="progress-bar" class="bg-gray-900 h-2 rounded-full progress-bar-fill" style="width: 0%"></div></div></div>
                    <div id="steps-container">
                        <!-- Paso 0: Detección de SO -->
                        <div id="step-0" class="step current"><div class="w-full max-w-lg mx-auto p-4 sm:p-6 flex flex-col flex-grow justify-center items-center text-center"><h1 class="text-4xl sm:text-5xl font-black mb-4 animated-item" data-depth-inside="0.2">¡Bienvenido!</h1><p class="text-base sm:text-lg text-gray-600 mb-6 animated-item" style="animation-delay: 100ms;" data-depth-inside="0.1">Este es el asistente de configuración de Eduroam.</p><div id="os-info" class="text-lg sm:text-xl font-bold p-4 bg-black/5 rounded-lg mb-8 animated-item" style="animation-delay: 200ms;" data-depth-inside="-0.1"></div><p class="text-sm text-gray-500 mb-4 animated-item" style="animation-delay: 300ms;">Si no es correcto, selecciona tu sistema:</p><div class="flex flex-wrap justify-center gap-4 animated-item" style="animation-delay: 400ms;" data-depth-inside="0.3"><button onclick="startGuide('Android')" class="bg-black text-white font-bold py-2 px-6 rounded-full hover:bg-gray-800 transition shadow-md hover:shadow-lg">Android</button><button onclick="startGuide('iOS')" class="bg-black text-white font-bold py-2 px-6 rounded-full hover:bg-gray-800 transition shadow-md hover:shadow-lg">iOS</button><button onclick="startGuide('Windows')" class="bg-black text-white font-bold py-2 px-6 rounded-full hover:bg-gray-800 transition shadow-md hover:shadow-lg">Windows</button></div></div></div>
                        
                        <!-- Pasos para Móviles (Android / iOS) -->
                        <div id="step-1" class="step future mobile-step"><div class="w-full max-w-lg mx-auto p-4 sm:p-6 flex flex-col flex-grow justify-center"><h2 class="text-sm font-semibold uppercase text-gray-500 animated-item" data-depth-inside="0.1">Asistente Vitrum x UCuenca</h2><h1 class="text-5xl sm:text-7xl font-black my-2 leading-none animated-item" style="animation-delay: 100ms;" data-depth-inside="0.3">Conéctate a</h1><h1 class="text-5xl sm:text-7xl font-black text-purple-600 animated-item" style="animation-delay: 200ms;" data-depth-inside="0.4">Eduroam</h1><p class="text-base sm:text-lg text-gray-600 mt-6 animated-item" style="animation-delay: 300ms;" data-depth-inside="0.2">Esta guía te ayudará en el proceso de configuración para acceder a la red Wi-Fi de la Universidad de Cuenca.</p></div></div>
                        <div id="step-2" class="step future mobile-step"><div class="w-full max-w-lg mx-auto p-4 sm:p-6 flex flex-col flex-grow justify-center"><h1 class="text-4xl sm:text-5xl font-black mb-6 animated-item" data-depth-inside="0.2">¿Qué es Eduroam?</h1><p class="mb-8 text-gray-600 animated-item" style="animation-delay: 100ms;" data-depth-inside="0.1">Eduroam (Education Roaming) es un servicio mundial que ofrece acceso a internet seguro y universal en todas las instituciones afiliadas.</p><ul class="space-y-4 text-left" data-depth-inside="-0.1"><li class="flex items-center animated-item" style="animation-delay: 200ms;"><svg class="w-6 h-6 mr-3 text-purple-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>Acceso global en universidades aliadas.</li><li class="flex items-center animated-item" style="animation-delay: 300ms;"><svg class="w-6 h-6 mr-3 text-purple-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>Conexión de alta velocidad y segura.</li><li class="flex items-center animated-item" style="animation-delay: 400ms;"><svg class="w-6 h-6 mr-3 text-purple-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>Una vez configurado, te conectarás automáticamente.</li></ul></div></div>
                        <div id="step-3" class="step future mobile-step"><div class="w-full max-w-lg mx-auto p-4 sm:p-6 flex flex-col flex-grow justify-center text-center"><div class="flex flex-col items-center gap-4 mb-6" data-depth-inside="-0.2"><svg class="w-16 h-16 text-purple-600 animated-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="1.jpg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><h1 class="text-4xl sm:text-5xl font-black animated-item" style="animation-delay: 100ms;" data-depth-inside="0.2">1. Prepárate</h1></div><p class="mb-4 text-gray-600 animated-item" style="animation-delay: 200ms;" data-depth-inside="0.1">Al final de la guía estará el enlace de instalación directa para tu dispositivo.</p><p class="mb-4 text-gray-600 animated-item" style="animation-delay: 300ms;" data-depth-inside="0.1">Se te guiará previamente cómo configurar la app eduroam y por ello es importante que prestes atención a todo el proceso de la guía.</p></div></div>
                        <div id="step-4" class="step future mobile-step"><div class="w-full max-w-lg mx-auto p-4 sm:p-6 flex flex-col flex-grow justify-center text-center"><div class="flex flex-col items-center gap-4 mb-6" data-depth-inside="-0.2"><svg class="w-16 h-16 text-purple-600 animated-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg><h1 class="text-4xl sm:text-5xl font-black animated-item" style="animation-delay: 100ms;" data-depth-inside="0.2">2. Busca tu Institución</h1></div><p class="mb-6 text-gray-600 animated-item" style="animation-delay: 200ms;" data-depth-inside="0.1">Abre la app y en el campo de búsqueda, escribe y selecciona <span class="font-bold">"Universidad de Cuenca"</span>.</p><div class="bg-black/5 w-full h-48 rounded-xl flex items-center justify-center animated-item overflow-hidden shadow-inner" style="animation-delay: 300ms;"><img src="1.jpg" alt="Paso 2: Buscar Institución" class="w-full h-full object-contain" onerror="this.onerror=null;this.src='https://placehold.co/400x200/e2e8f0/4a5568?text=Paso+2';"></div></div></div>
                        <div id="step-5" class="step future mobile-step"><div class="w-full max-w-lg mx-auto p-4 sm:p-6 flex flex-col flex-grow justify-center text-center"><div class="flex flex-col items-center gap-4 mb-6" data-depth-inside="-0.2"><svg class="w-16 h-16 text-green-600 animated-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg><h1 class="text-4xl sm:text-5xl font-black animated-item" style="animation-delay: 100ms;" data-depth-inside="0.2">3. Ingresa tus Datos</h1></div><p class="mb-6 text-gray-600 animated-item" style="animation-delay: 200ms;" data-depth-inside="0.1">Ingresa tu correo institucional y contraseña.</p><div class="space-y-4 text-left" data-depth-inside="-0.1"><div class="bg-black/5 p-4 rounded-xl animated-item" style="animation-delay: 300ms;"><label class="text-sm text-gray-500">Correo Institucional</label><p class="font-mono text-gray-800 text-sm sm:text-base">tu.usuario@ucuenca.edu.ec</p></div><div class="bg-black/5 p-4 rounded-xl animated-item" style="animation-delay: 400ms;"><label class="text-sm text-gray-500">Contraseña</label><p class="font-mono text-gray-800">••••••••••</p></div></div></div></div>
                        <div id="step-6" class="step future mobile-step"><div class="w-full max-w-lg mx-auto p-4 sm:p-6 flex flex-col flex-grow justify-center text-center"><h1 class="text-4xl sm:text-5xl font-black mb-6 animated-item" data-depth-inside="0.2">4. Guarda la Red</h1><p class="text-lg mb-6 text-gray-600 animated-item" style="animation-delay: 100ms;" data-depth-inside="0.1">¡Atención! Después de ingresar tus datos, aparecerá una ventana emergente. Presiona en <span class="font-bold">"Guardar"</span> o <span class="font-bold">"Conectar"</span>.</p><div class="bg-yellow-400/20 text-yellow-800 border-l-4 border-yellow-500 p-4 rounded-r-lg animated-item text-left" style="animation-delay: 200ms;" data-depth-inside="-0.1"><p class="font-bold">Paso Crucial</p><p>No omitas esta ventana. Es necesaria para que tu dispositivo recuerde la red.</p></div></div></div>
                        <div id="step-7" class="step future mobile-step"><div class="w-full max-w-lg mx-auto p-4 sm:p-6 flex flex-col flex-grow justify-center text-center"><h1 class="text-4xl sm:text-5xl font-black mb-6 animated-item" data-depth-inside="0.2">5. Permiso Final</h1><p class="text-lg mb-6 text-gray-600 animated-item" style="animation-delay: 100ms;" data-depth-inside="0.1">Sal de la aplicación. Es posible que el sistema te pida un último permiso. Debes presionar en <span class="font-bold">"Permitir"</span>.</p><div class="bg-black/5 w-full h-48 rounded-xl flex items-center justify-center animated-item overflow-hidden shadow-inner" style="animation-delay: 200ms;"><img src="2.jpg" alt="Paso 5: Permiso Final" class="w-full h-full object-contain" onerror="this.onerror=null;this.src='https://placehold.co/400x200/e2e8f0/4a5568?text=Paso+5';"></div></div></div>
                        <div id="step-8" class="step future mobile-step"><div class="w-full max-w-lg mx-auto p-4 sm:p-6 flex flex-col flex-grow justify-center items-center text-center"><div class="text-8xl mb-6 animated-item" style="animation: final-pop 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;" data-depth-inside="-0.3">🚀</div><h1 class="text-4xl sm:text-5xl font-black mb-4 animated-item" style="animation-delay: 100ms;" data-depth-inside="0.2">Inicia el Proceso</h1><p class="text-lg text-gray-600 mb-8 animated-item" style="animation-delay: 200ms;" data-depth-inside="0.1">Inicia el proceso de configuración como lo detallamos en esta guía. Si te pierdes, no te preocupes, siempre puedes regresar y volver a ver esta guía.</p><a id="install-link" href="https://play.google.com/store/apps/details?id=app.eduroam.geteduroam" target="_blank" class="block w-full text-center bg-blue-600 text-white font-bold py-4 px-6 rounded-full hover:bg-blue-700 transition text-lg animated-item" style="animation-delay: 300ms;" data-depth-inside="0.4">Instalar geteduroam</a><button onclick="restartGuide()" class="mt-4 text-gray-500 font-bold py-2 px-6 rounded-full hover:bg-black/5 transition animated-item" style="animation-delay: 400ms;" data-depth-inside="0.3">Reiniciar Guía</button></div></div>

                        <!-- Pasos para Windows -->
                        <div id="step-win-1" class="step future windows-step hidden"><div class="w-full max-w-lg mx-auto p-4 sm:p-6 flex flex-col flex-grow justify-center text-center"><h1 class="text-4xl sm:text-5xl font-black mb-6 animated-item" data-depth-inside="0.2">1. Accede a Wi-Fi</h1><p class="mb-6 text-gray-600 animated-item" style="animation-delay: 100ms;" data-depth-inside="0.1">Haz clic en el ícono de <span class="font-bold">Wi-Fi</span> en tu barra de tareas, usualmente en la esquina inferior derecha.</p><div class="w-full h-48 rounded-xl flex items-center justify-center animated-item" style="animation-delay: 200ms;"><svg id="wifi-icon-anim" viewBox="0 0 100 100" class="h-32 w-32"><g class="wifi-symbol"><path d="M50 70 a 20 20 0 0 1 30 0 l 5 5 a 28 28 0 0 0 -40 0 l 5 -5z"></path><path d="M50 55 a 35 35 0 0 1 45 0 l 5 5 a 43 43 0 0 0 -55 0 l 5 -5z"></path><path d="M50 40 a 50 50 0 0 1 60 0 l 5 5 a 58 58 0 0 0 -70 0 l 5 -5z"></path></g><path class="cursor" fill="#1a1a1a" d="M60 75 l 15 20 l -5 5 l -15 -20 z M 55 95 l 20 -15 l 5 5 l -20 15 z"></path></svg></div></div></div>
                        <div id="step-win-2" class="step future windows-step hidden"><div class="w-full max-w-lg mx-auto p-4 sm:p-6 flex flex-col flex-grow justify-center text-center"><h1 class="text-4xl sm:text-5xl font-black mb-6 animated-item" data-depth-inside="0.2">2. Selecciona Eduroam</h1><p class="mb-6 text-gray-600 animated-item" style="animation-delay: 100ms;" data-depth-inside="0.1">En la lista de redes disponibles, busca y haz clic en <span class="font-bold">"eduroam"</span>. Asegúrate de que la opción "Conectar automáticamente" esté marcada.</p><div class="bg-black/5 w-full p-4 rounded-xl flex flex-col gap-2 animated-item text-left shadow-inner" style="animation-delay: 200ms;"><div class="p-3 bg-white/50 rounded-lg">Otra Red</div><div class="p-3 bg-blue-500/20 text-blue-800 font-bold ring-2 ring-blue-500 rounded-lg">eduroam</div><div class="p-3 bg-white/50 rounded-lg">Red Vecino</div></div></div></div>
                        <div id="step-win-3" class="step future windows-step hidden"><div class="w-full max-w-lg mx-auto p-4 sm:p-6 flex flex-col flex-grow justify-center text-center"><h1 class="text-4xl sm:text-5xl font-black animated-item" style="animation-delay: 100ms;" data-depth-inside="0.2">3. Ingresa tus Datos</h1><p class="mb-6 text-gray-600 animated-item" style="animation-delay: 200ms;" data-depth-inside="0.1">El sistema te pedirá tus credenciales. Ingresa tu correo institucional completo y tu contraseña.</p><div class="space-y-4 text-left" data-depth-inside="-0.1"><div class="bg-black/5 p-4 rounded-xl animated-item" style="animation-delay: 300ms;"><label class="text-sm text-gray-500">Nombre de usuario</label><p class="font-mono text-gray-800 text-sm sm:text-base">tu.usuario@ucuenca.edu.ec</p></div><div class="bg-black/5 p-4 rounded-xl animated-item" style="animation-delay: 400ms;"><label class="text-sm text-gray-500">Contraseña</label><p class="font-mono text-gray-800">••••••••••</p></div></div></div></div>
                        <div id="step-win-4" class="step future windows-step hidden"><div class="w-full max-w-lg mx-auto p-4 sm:p-6 flex flex-col flex-grow justify-center items-center text-center"><div class="text-8xl mb-6 animated-item" style="animation: final-pop 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;" data-depth-inside="-0.3">🎉</div><h1 class="text-4xl sm:text-5xl font-black mb-4 animated-item" style="animation-delay: 100ms;" data-depth-inside="0.2">¡Todo Listo!</h1><p class="text-lg text-gray-600 mb-8 animated-item" style="animation-delay: 200ms;" data-depth-inside="0.1">Tu dispositivo Windows ahora está conectado a Eduroam. La próxima vez que estés en el campus, se conectará automáticamente.</p><button onclick="restartGuide()" class="mt-4 text-gray-500 font-bold py-2 px-6 rounded-full hover:bg-black/5 transition animated-item" style="animation-delay: 300ms;" data-depth-inside="0.3">Reiniciar Guía</button></div></div>
                    </div>
                    <!-- Navegación -->
                    <div id="navigation" class="p-4 sm:p-6 mt-auto flex-shrink-0 flex justify-between items-center opacity-0" style="transition: opacity 0.5s;" data-depth-inside="0.5"><button id="back-btn" onclick="navigate(-1)" class="font-bold text-gray-500 py-3 px-4 hover:text-black transition">Atrás</button><button id="next-btn" onclick="navigate(1)" class="bg-black text-white font-bold py-4 px-10 rounded-full hover:bg-gray-800 transition shadow-md hover:shadow-lg">Siguiente</button></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 0;
        let steps = document.querySelectorAll('.step');
        let totalSteps = steps.length - 1; 
        const progressBar = document.getElementById('progress-bar');
        const navigation = document.getElementById('navigation');
        const nextBtn = document.getElementById('next-btn');

        function vibrateDevice(duration = 50) {
            if (navigator.vibrate) {
                navigator.vibrate(duration);
            }
        }

        function updateUI() {
            steps.forEach((step, index) => {
                step.classList.remove('current', 'past', 'future');
                if (index === currentStep) step.classList.add('current');
                else if (index < currentStep) step.classList.add('past');
                else step.classList.add('future');
            });
            
            // La barra de progreso se calcula sobre el total de pasos VISIBLES.
            const progress = currentStep > 0 ? ((currentStep - 1) / (totalSteps - 2)) * 100 : 0;
            progressBar.style.width = `${Math.min(progress, 100)}%`;
            
            // Ocultar navegación en el primer y último paso.
            const isNavVisible = currentStep > 0 && currentStep < totalSteps;
            navigation.style.opacity = isNavVisible ? '1' : '0';
            navigation.style.pointerEvents = isNavVisible ? 'auto' : 'none';

            document.getElementById('back-btn').style.visibility = (currentStep <= 1) ? 'hidden' : 'visible';
            nextBtn.textContent = (currentStep === totalSteps - 1) ? 'Finalizar' : 'Siguiente';
        }

        function navigate(direction) {
            vibrateDevice();
            const newStep = currentStep + direction;
            if (newStep >= 0 && newStep <= totalSteps) {
                currentStep = newStep;
                updateUI();
            }
        }
        
        function startGuide(os) {
            vibrateDevice();

            document.querySelectorAll('.mobile-step').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.windows-step').forEach(el => el.classList.add('hidden'));

            if (os === 'Windows') {
                document.querySelectorAll('.windows-step').forEach(el => el.classList.remove('hidden'));
            } else { // Android or iOS
                document.querySelectorAll('.mobile-step').forEach(el => el.classList.remove('hidden'));
                const installLink = document.getElementById('install-link');
                if (os === 'iOS') {
                    installLink.href = 'https://apps.apple.com/es/app/geteduroam/id1504076137';
                } else {
                    installLink.href = 'https://play.google.com/store/apps/details?id=app.eduroam.geteduroam';
                }
            }
            
            // Recalcular los pasos visibles para la navegación
            steps = document.querySelectorAll('.step:not(.hidden)');
            totalSteps = steps.length - 1;
            
            if (currentStep === 0) {
                currentStep = 1;
            }
            updateUI();
        }

        function restartGuide() {
            vibrateDevice();
            document.querySelectorAll('.step').forEach(el => el.classList.remove('hidden'));
            document.querySelectorAll('.windows-step, .mobile-step').forEach(el => el.classList.add('hidden'));

            currentStep = 0;
            steps = document.querySelectorAll('.step:not(.hidden)');
            totalSteps = steps.length - 1;
            updateUI();
        }

        function getDetectedOS() {
            if (navigator.userAgent.match(/Android/i)) return "Android";
            if (navigator.userAgent.match(/iPhone|iPad|iPod/i)) return "iOS";
            if (navigator.userAgent.match(/Windows/i)) return "Windows";
            if (navigator.userAgent.match(/Mac/i)) return "macOS";
            if (navigator.userAgent.match(/Linux/i)) return "Linux";
            return "Desconocido";
        }

        function getOSLogo(os) {
            switch (os) {
                case "Android": return `<img src="https://upload.wikimedia.org/wikipedia/commons/6/66/Android_robot.png" alt="Android Logo" class="w-full h-full object-contain rounded-3xl">`;
                case "iOS": return `<img src="https://cdn3.iconfinder.com/data/icons/social-media-logos-glyph/2048/5315_-_Apple-512.png" alt="iOS Logo" class="w-full h-full object-contain rounded-3xl">`;
                case "Windows": return `<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e2/Windows_logo_and_wordmark_-_2021.svg/512px-Windows_logo_and_wordmark_-_2021.svg.png" alt="Windows Logo" class="w-full h-full object-contain">`;
                default: return `<img src="https://static.vecteezy.com/system/resources/thumbnails/012/794/638/small/3d-unknown-devices-rendered-object-illustration-png.png" alt="Generic OS Logo" class="w-full h-full object-contain rounded-3xl">`;
            }
        }
        
        let fallbackTimeout = null;

        function transitionToShakeState() {
            const detectionState = document.getElementById('detection-state');
            const shakeState = document.getElementById('shake-state');
            const osLogoContainer = document.getElementById('os-logo-container');
            const splashScreen = document.getElementById('splash-screen');

            const os = getDetectedOS();
            osLogoContainer.innerHTML = getOSLogo(os);

            detectionState.style.opacity = '0';

            setTimeout(() => {
                detectionState.classList.add('hidden');
                shakeState.classList.remove('hidden');
                shakeState.style.display = 'flex';
                splashScreen.classList.add('glass-active');
                setTimeout(() => {
                    shakeState.style.opacity = '1';
                    initShakeDetection();
                }, 50);
            }, 500);
        }

        function initParticleScanner() {
            const canvas = document.getElementById('particle-canvas');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            let particles = [];
            const numParticles = 150;
            let animationFrameId;
            let phase = 'exploding';
            class Particle { constructor() { this.x = canvas.width / 2; this.y = canvas.height / 2; const angle = Math.random() * Math.PI * 2; const speed = Math.random() * 4 + 1; this.vx = Math.cos(angle) * speed; this.vy = Math.sin(angle) * speed; this.radius = Math.random() * 2 + 1; this.color = `rgba(51, 51, 51, ${Math.random() * 0.5 + 0.2})`; } update() { this.x += this.vx; this.y += this.vy; } draw() { ctx.beginPath(); ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2); ctx.fillStyle = this.color; ctx.fill(); } }
            function createParticles() { for (let i = 0; i < numParticles; i++) { particles.push(new Particle()); } }
            function animateParticles() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                let allParticlesImploded = true;
                for (let i = particles.length - 1; i >= 0; i--) { const p = particles[i]; if (phase === 'exploding') { p.update(); } else if (phase === 'imploding') { const dx = canvas.width / 2 - p.x; const dy = canvas.height / 2 - p.y; const dist = Math.sqrt(dx * dx + dy * dy); const speed = 5; if (dist > speed) { p.x += (dx / dist) * speed; p.y += (dy / dist) * speed; allParticlesImploded = false; } else { p.x = canvas.width/2; p.y = canvas.height/2; } } p.draw(); }
                if (phase === 'imploding' && allParticlesImploded) { cancelAnimationFrame(animationFrameId); transitionToShakeState(); return; }
                animationFrameId = requestAnimationFrame(animateParticles);
            }
            createParticles();
            animateParticles();
            setTimeout(() => { phase = 'imploding'; }, 2500);
        }

        function startApp() {
            if (fallbackTimeout) clearTimeout(fallbackTimeout);
            initParallax();
            document.getElementById('splash-screen').style.opacity = '0';
            document.getElementById('splash-screen').style.pointerEvents = 'none';
            document.querySelector('.glass-pane').classList.add('visible');
            const os = getDetectedOS();
            document.getElementById('os-info').textContent = `Detectado: ${os}`;

            // Ocultar los pasos específicos de SO al inicio
            document.querySelectorAll('.mobile-step, .windows-step').forEach(el => el.classList.add('hidden'));
            steps = document.querySelectorAll('.step:not(.hidden)');
            totalSteps = steps.length - 1;
            
            updateUI();

            if ((os === "Android" || os === "iOS") && currentStep === 0) {
                setTimeout(() => { if (currentStep === 0) startGuide(os); }, 1500);
            }
        }
        
        function initShakeDetection() {
            const SHAKE_THRESHOLD = 20;
            let motionListener = null;
            const handleMotionEvent = (event) => { const { x, y, z } = event.accelerationIncludingGravity; const acceleration = Math.sqrt(x*x + y*y + z*z); if (acceleration > SHAKE_THRESHOLD) { vibrateDevice(100); window.removeEventListener('devicemotion', motionListener); startApp(); } };
            motionListener = handleMotionEvent;
            fallbackTimeout = setTimeout(() => { const fallbackBtn = document.getElementById('fallback-btn'); fallbackBtn.classList.remove('hidden'); setTimeout(() => fallbackBtn.style.opacity = '1', 50); }, 3000);
            document.getElementById('fallback-btn').addEventListener('click', () => { startApp(); });
            if (typeof DeviceMotionEvent !== 'undefined' && typeof DeviceMotionEvent.requestPermission === 'function') {
                const iosPermissionText = document.getElementById('ios-permission-text');
                iosPermissionText.classList.remove('hidden');
                const requestMotionPermission = () => { Promise.all([ DeviceMotionEvent.requestPermission(), DeviceOrientationEvent.requestPermission() ]).then(results => { let motionGranted = results[0] === 'granted'; if (motionGranted) { window.addEventListener('devicemotion', motionListener); } if (motionGranted || results[1] === 'granted') { iosPermissionText.textContent = "¡Sensores activados! Ahora agita el dispositivo."; } else { iosPermissionText.textContent = "Permiso de sensores denegado. Algunas funciones no estarán disponibles."; } }).catch(console.error); document.getElementById('splash-screen').removeEventListener('click', requestMotionPermission); };
                document.getElementById('splash-screen').addEventListener('click', requestMotionPermission);
            } else { window.addEventListener('devicemotion', motionListener); }
        }

        function initParallax() {
            const scene = document.getElementById('parallax-scene');
            const layers = scene.querySelectorAll('.layer');
            const glassPane = document.querySelector('.glass-pane');
            const parallaxItems = document.querySelectorAll('[data-depth-inside]');
            const sensitivity = 50;
            glassPane.classList.add('parallax-active');
            const handleMove = (x_ratio, y_ratio) => {
                layers.forEach(layer => { const depth = layer.getAttribute('data-depth'); const x_axis = -x_ratio * sensitivity * depth; const y_axis = -y_ratio * sensitivity * depth; layer.style.transform = `translate3d(${x_axis}px, ${y_axis}px, 0)`; });
                parallaxItems.forEach(item => { const depth = item.getAttribute('data-depth-inside'); const x_axis = -x_ratio * sensitivity * depth; const y_axis = -y_ratio * sensitivity * depth; item.style.transform = `translate3d(${x_axis}px, ${y_axis}px, 0)`; });
                const rotateY = x_ratio * -12; const rotateX = y_ratio * 12; glassPane.style.transform = `scale(1) rotateY(${rotateY}deg) rotateX(${rotateX}deg)`;
            };
            if (window.DeviceOrientationEvent && 'ontouchstart' in window) { window.addEventListener('deviceorientation', (event) => { const beta = event.beta; const gamma = event.gamma; const y_ratio = Math.max(-1, Math.min(1, beta / 90)); const x_ratio = Math.max(-1, Math.min(1, gamma / 90)); handleMove(x_ratio, y_ratio); }); } else { window.addEventListener('mousemove', (event) => { const x_ratio = (event.clientX / window.innerWidth) - 0.5; const y_ratio = (event.clientY / window.innerHeight) - 0.5; handleMove(x_ratio, y_ratio); }); }
        }

        document.addEventListener('DOMContentLoaded', initParticleScanner);
    </script>
</body>
</html>

